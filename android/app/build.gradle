plugins {
  id("com.android.application")
  id("org.jetbrains.kotlin.android")
  id("com.facebook.react")
  id("com.google.gms.google-services")
}

react {
  // 기본값 사용 (autolinkLibrariesWithApp 호출 불필요)
}

android {
  namespace "com.finguard"

  compileSdk 35
  buildToolsVersion "35.0.0"
  ndkVersion "27.1.12297006"

  defaultConfig {
    applicationId "com.finguard"
    // RN 0.75 권장 minSdk 24+
    minSdkVersion 24
    targetSdkVersion 35

    // CI에서 넘겨주는 버전 값 사용
    versionCode project.hasProperty("VERSION_CODE") ? project.VERSION_CODE.toInteger() : 1
    versionName project.hasProperty("VERSION_NAME") ? project.VERSION_NAME : "0.1.0"
  }

  compileOptions {
    sourceCompatibility JavaVersion.VERSION_17
    targetCompatibility JavaVersion.VERSION_17
  }
  kotlinOptions {
    jvmTarget = "17"
  }

  buildTypes {
    debug {
      signingConfig signingConfigs.debug
    }
    release {
      minifyEnabled false
      shrinkResources false
      proguardFiles(
        getDefaultProguardFile("proguard-android-optimize.txt"),
        "proguard-rules.pro"
      )
    }
  }

  packaging {
    resources {
      // 충돌나는 META-INF 파일들 우선 선택
      pickFirsts += ["META-INF/*"]
    }
  }
}

dependencies {
  // RN 0.75.x BOM으로 버전 정합성 유지
  implementation(platform("com.facebook.react:react-native-bom:0.75.4"))
  implementation("com.facebook.react:react-android")

  def hermesEnabled = (project.findProperty("hermesEnabled") ?: "true").toBoolean()
  if (hermesEnabled) {
    implementation("com.facebook.react:hermes-android")
  } else {
    implementation("io.github.react-native-community:jsc-android:250230.2.1")
  }

  // 사용 중인 Google/Firebase 라이브러리
  implementation("com.google.android.gms:play-services-base:18.5.0")
  implementation("com.google.android.gms:play-services-location:21.2.0")
  implementation("com.google.firebase:firebase-messaging:23.4.0")
}
