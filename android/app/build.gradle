

plugins {
  id "com.android.application"
  id "org.jetbrains.kotlin.android"
  id "com.facebook.react"
  id "com.google.gms.google-services"
}

def hermesEnabled = (findProperty("hermesEnabled") ?: "true").toString().toBoolean()
def jscFlavor = "io.github.react-native-community:jsc-android:2026004.+"

android {
  namespace "com.finguard"
  compileSdk 35

  defaultConfig {
    applicationId "com.finguard"
    minSdk 24
    targetSdk 35


    def vc = (project.findProperty("VERSION_CODE")
            ?: project.findProperty("versionCode") ?: "1") as String
    def vn = (project.findProperty("VERSION_NAME")
            ?: project.findProperty("versionName") ?: "1.0.0") as String
    versionCode vc.toInteger()
    versionName vn
  }

  signingConfigs {
    debug {
      storeFile file('debug.keystore')
      storePassword 'android'
      keyAlias 'androiddebugkey'
      keyPassword 'android'
    }


    release {

      def ksPath = System.getenv("ANDROID_KEYSTORE_PATH") ?: "release.keystore"
      storeFile file(ksPath)
      storePassword System.getenv("ANDROID_KEYSTORE_PASSWORD")
      keyAlias System.getenv("ANDROID_SIGNING_KEY_ALIAS")
      keyPassword System.getenv("ANDROID_SIGNING_KEY_PASSWORD")

      // PKCS12 사용 시: ANDROID_KEYSTORE_TYPE=pkcs12
      def ksType = System.getenv("ANDROID_KEYSTORE_TYPE")
      if (ksType != null && ksType.trim()) {
        storeType ksType
      }
    }
  }

  buildTypes {
    debug { signingConfig signingConfigs.debug }

    release {
      signingConfig signingConfigs.release
      minifyEnabled false
      shrinkResources false
      proguardFiles getDefaultProguardFile("proguard-android-optimize.txt"),
                    "proguard-rules.pro"
    }
  }


  compileOptions {
    sourceCompatibility JavaVersion.VERSION_17
    targetCompatibility JavaVersion.VERSION_17
  }
  kotlinOptions {
    jvmTarget = "17"
  }
}

dependencies {

  implementation "com.facebook.react:react-android"


  implementation "com.google.android.gms:play-services-base:18.5.0"
  implementation "com.google.android.gms:play-services-tasks:18.0.2"
  implementation "com.google.android.gms:play-services-location:21.2.0"


  implementation "com.google.firebase:firebase-messaging:23.4.0"


  if (hermesEnabled) {
    implementation "com.facebook.react:hermes-android"
  } else {
    implementation jscFlavor
  }
}


configurations.all {
  resolutionStrategy {
    force "com.google.android.gms:play-services-base:18.5.0"
    force "com.google.android.gms:play-services-tasks:18.0.2"
    force "com.google.android.gms:play-services-location:21.2.0"
  }
}
